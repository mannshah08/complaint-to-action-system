<!DOCTYPE html>
<html>

<head>
    <title>AI Complaint System</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <div class="top-bar">
        <a href="/" class="home-btn">üè† Home</a>
        <a href="/community" class="home-btn">üåç Community Pulse</a>
    </div>


    <div class="container">
        <h1>Complaint to Action System</h1>

        {% if request.args.get("success") %}
        <p style="color: green;"><b>Complaint submitted successfully.</b></p>
        {% endif %}

        <form action="/submit" method="post">

            <label><b>Name:</b></label><br>
            <input type="text" name="name" required><br><br>

            <label><b>Role:</b></label><br>
            <select name="role" id="roleSelect" required onchange="toggleAdminLogin()">
                <option value="">Select your role</option>
                <option value="Student">Student</option>
                <option value="Visitor">Visitor / Other</option>
                <option value="Staff/Admin">Staff / Admin</option>
            </select>
            <br><br>

            <label><b>Complaint Visibility</b></label><br>
            <select name="visibility" required>
                <option value="">Choose one</option>
                <option value="Public">Public (Visible to community)</option>
                <option value="Private">Private (Only admin)</option>
            </select><br><br>

            <label><b>Describe your issue:</b></label><br><br>
            <textarea name="complaint" rows="6" required></textarea><br><br>

            <button type="submit">Submit Complaint</button>
        </form>

        <div id="adminLoginBtn" style="display:none; margin-top:20px;">
            <a href="/login" class="admin-btn">üîê Admin Login</a>
        </div>


        <script>
            function toggleAdminLogin() {
                const role = document.getElementById("roleSelect").value;
                const adminBtn = document.getElementById("adminLoginBtn");

                if (role === "Staff/Admin") {
                    adminBtn.style.display = "block";
                } else {
                    adminBtn.style.display = "none";
                }
            }
        </script>

    </div>
    <!-- Admin Login Popup -->
    <div id="loginPopup"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
        <div style="background:white; width:300px; padding:20px; margin:100px auto; border-radius:5px;">
            <h3>Admin Login</h3>
            <form action="/login" method="post">
                <input type="password" name="password" placeholder="Enter password" required><br><br>
                <button type="submit">Login</button>
                <button type="button" onclick="closePopup()">Cancel</button>
            </form>
        </div>
    </div>

    <script>
        document.querySelectorAll("form").forEach(form => {
            form.addEventListener("submit", () => {
                const btn = form.querySelector("button");
                if (btn) {
                    btn.disabled = true;
                    btn.innerText = "Processing...";
                }
            });
        });
    </script>

</body>

</html>